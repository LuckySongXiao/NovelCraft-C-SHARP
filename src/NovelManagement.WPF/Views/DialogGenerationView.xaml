<UserControl x:Class="NovelManagement.WPF.Views.DialogGenerationView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             mc:Ignorable="d" 
             d:DesignHeight="800" d:DesignWidth="1200">
    
    <UserControl.Resources>
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
        
        <Style x:Key="InfoCardStyle" TargetType="materialDesign:Card">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="15"/>
            <Setter Property="materialDesign:ShadowAssist.ShadowDepth" Value="Depth1"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 标题栏 -->
        <materialDesign:Card Grid.Row="0" Margin="10" Padding="20" materialDesign:ShadowAssist.ShadowDepth="Depth2">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="MessageText" Width="32" Height="32" 
                                           Foreground="{DynamicResource PrimaryHueMidBrush}" 
                                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <StackPanel>
                        <TextBlock Text="AI对话生成器" FontSize="24" FontWeight="Bold"/>
                        <TextBlock Text="智能生成角色对话，支持多种风格和情感表达" 
                                 FontSize="14" Opacity="0.7"/>
                    </StackPanel>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button x:Name="SaveTemplateButton" Content="保存模板" 
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Margin="5" Click="SaveTemplate_Click"/>
                    <Button x:Name="LoadTemplateButton" Content="加载模板" 
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Margin="5" Click="LoadTemplate_Click"/>
                    <Button x:Name="HelpButton" Content="帮助" 
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Margin="5" Click="Help_Click"/>
                </StackPanel>
            </Grid>
        </materialDesign:Card>

        <!-- 主要内容区域 -->
        <Grid Grid.Row="1" Margin="10">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="1*"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>

            <!-- 左侧：参数配置区域 -->
            <materialDesign:Card Grid.Column="0" Style="{StaticResource InfoCardStyle}" Margin="0,0,5,0">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="对话生成参数" Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <!-- 角色设置 -->
                        <Expander Header="角色设置" IsExpanded="True" Margin="0,10">
                            <StackPanel Margin="20,10">
                                <TextBlock Text="参与角色" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="CharactersTextBox" 
                                       materialDesign:HintAssist.Hint="输入角色名称，用逗号分隔"
                                       Text="主角,配角A"
                                       Margin="0,0,0,10"/>
                                
                                <TextBlock Text="角色关系" FontWeight="Bold" Margin="0,10,0,5"/>
                                <ComboBox x:Name="RelationshipComboBox" 
                                        materialDesign:HintAssist.Hint="选择角色关系"
                                        Margin="0,0,0,10">
                                    <ComboBoxItem Content="朋友"/>
                                    <ComboBoxItem Content="恋人"/>
                                    <ComboBoxItem Content="敌人"/>
                                    <ComboBoxItem Content="师徒"/>
                                    <ComboBoxItem Content="上下级"/>
                                    <ComboBoxItem Content="陌生人"/>
                                    <ComboBoxItem Content="家人"/>
                                </ComboBox>
                                
                                <Button x:Name="SelectCharactersButton" Content="从角色库选择" 
                                      Style="{StaticResource MaterialDesignOutlinedButton}"
                                      Click="SelectCharacters_Click"/>
                            </StackPanel>
                        </Expander>

                        <!-- 情境设置 -->
                        <Expander Header="情境设置" IsExpanded="True" Margin="0,10">
                            <StackPanel Margin="20,10">
                                <TextBlock Text="对话场景" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBox x:Name="SituationTextBox" 
                                       materialDesign:HintAssist.Hint="描述对话发生的场景和背景"
                                       Text="在修炼室中讨论修炼心得"
                                       AcceptsReturn="True" 
                                       Height="80"
                                       TextWrapping="Wrap"
                                       Margin="0,0,0,10"/>
                                
                                <TextBlock Text="对话目的" FontWeight="Bold" Margin="0,10,0,5"/>
                                <ComboBox x:Name="PurposeComboBox" 
                                        materialDesign:HintAssist.Hint="选择对话目的"
                                        Margin="0,0,0,10">
                                    <ComboBoxItem Content="推进剧情"/>
                                    <ComboBoxItem Content="角色发展"/>
                                    <ComboBoxItem Content="信息传递"/>
                                    <ComboBoxItem Content="情感表达"/>
                                    <ComboBoxItem Content="冲突展现"/>
                                    <ComboBoxItem Content="氛围营造"/>
                                </ComboBox>
                            </StackPanel>
                        </Expander>

                        <!-- 风格设置 -->
                        <Expander Header="风格设置" IsExpanded="True" Margin="0,10">
                            <StackPanel Margin="20,10">
                                <TextBlock Text="情感基调" FontWeight="Bold" Margin="0,0,0,5"/>
                                <ComboBox x:Name="EmotionComboBox" 
                                        materialDesign:HintAssist.Hint="选择情感基调"
                                        Margin="0,0,0,10">
                                    <ComboBoxItem Content="平静"/>
                                    <ComboBoxItem Content="高兴"/>
                                    <ComboBoxItem Content="愤怒"/>
                                    <ComboBoxItem Content="悲伤"/>
                                    <ComboBoxItem Content="紧张"/>
                                    <ComboBoxItem Content="兴奋"/>
                                    <ComboBoxItem Content="恐惧"/>
                                    <ComboBoxItem Content="惊讶"/>
                                </ComboBox>
                                
                                <TextBlock Text="语言风格" FontWeight="Bold" Margin="0,10,0,5"/>
                                <ComboBox x:Name="StyleComboBox" 
                                        materialDesign:HintAssist.Hint="选择语言风格"
                                        Margin="0,0,0,10">
                                    <ComboBoxItem Content="现代口语"/>
                                    <ComboBoxItem Content="古典文雅"/>
                                    <ComboBoxItem Content="武侠风格"/>
                                    <ComboBoxItem Content="仙侠风格"/>
                                    <ComboBoxItem Content="现代都市"/>
                                    <ComboBoxItem Content="科幻未来"/>
                                </ComboBox>
                                
                                <TextBlock Text="对话长度" FontWeight="Bold" Margin="0,10,0,5"/>
                                <Slider x:Name="LengthSlider" 
                                      Minimum="1" Maximum="10" Value="5" 
                                      TickFrequency="1" IsSnapToTickEnabled="True"
                                      Margin="0,0,0,5"/>
                                <TextBlock x:Name="LengthLabel" Text="中等长度" 
                                         HorizontalAlignment="Center" FontSize="12" Opacity="0.7"/>
                            </StackPanel>
                        </Expander>

                        <!-- 生成按钮 -->
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20">
                            <Button x:Name="GenerateButton" Content="生成对话" 
                                  Style="{StaticResource MaterialDesignRaisedButton}"
                                  Width="120" Height="40"
                                  Click="Generate_Click"/>
                            <Button x:Name="OptimizeButton" Content="优化对话" 
                                  Style="{StaticResource MaterialDesignOutlinedButton}"
                                  Width="120" Height="40" Margin="10,0,0,0"
                                  Click="Optimize_Click"/>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </materialDesign:Card>

            <!-- 右侧：结果显示区域 -->
            <materialDesign:Card Grid.Column="1" Style="{StaticResource InfoCardStyle}" Margin="5,0,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- 结果标题 -->
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="生成结果" Style="{StaticResource SectionHeaderStyle}"/>
                        <materialDesign:Chip x:Name="QualityChip" Content="质量评分: --" 
                                           Margin="20,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>

                    <!-- 对话内容显示 -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <TextBox x:Name="ResultTextBox" 
                               materialDesign:HintAssist.Hint="生成的对话将显示在这里..."
                               AcceptsReturn="True" 
                               TextWrapping="Wrap"
                               IsReadOnly="False"
                               MinHeight="400"/>
                    </ScrollViewer>

                    <!-- 操作按钮 -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                        <Button x:Name="CopyButton" Content="复制" 
                              Style="{StaticResource MaterialDesignOutlinedButton}"
                              Margin="5" Click="Copy_Click"/>
                        <Button x:Name="SaveButton" Content="保存" 
                              Style="{StaticResource MaterialDesignOutlinedButton}"
                              Margin="5" Click="Save_Click"/>
                        <Button x:Name="ExportButton" Content="导出" 
                              Style="{StaticResource MaterialDesignOutlinedButton}"
                              Margin="5" Click="Export_Click"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>
        </Grid>

        <!-- 加载指示器 -->
        <Grid x:Name="LoadingOverlay" Grid.RowSpan="2" Background="#80000000" Visibility="Collapsed">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar Style="{StaticResource MaterialDesignCircularProgressBar}" 
                           Width="50" Height="50" IsIndeterminate="True"/>
                <TextBlock x:Name="LoadingText" Text="正在生成对话..." 
                         Foreground="White" FontSize="16" Margin="0,20,0,0" 
                         HorizontalAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
