I will implement the Zhipu AI (GLM-4.7-flash) integration and connect it to the global agent system.

### 1. Create Zhipu AI Service Infrastructure
I will create the necessary classes and interfaces to support Zhipu AI as a first-class model provider in the system.

-   **Configuration**: Create `src/NovelManagement.AI/Services/Zhipu/Models/ZhipuConfiguration.cs` to store API keys, base URL (defaulting to `https://open.bigmodel.cn/api/paas/v4/`), and default model (`glm-4.7-flash`).
-   **Interface**: Create `src/NovelManagement.AI/Services/Zhipu/IZhipuApiService.cs` which inherits from `IModelProvider`.
-   **Implementation**: Create `src/NovelManagement.AI/Services/Zhipu/ZhipuApiService.cs` implementing the interface. It will handle HTTP communication with the Zhipu API, including standard and streaming chat completions.

### 2. Register Services and Configuration
I will integrate the new service into the application's dependency injection and configuration systems.

-   **Service Registration**: Update `src/NovelManagement.AI/Extensions/ServiceCollectionExtensions.cs` to register `IZhipuApiService` and `ZhipuApiService`.
-   **App Startup**: Update `src/NovelManagement.WPF/App.xaml.cs` to:
    -   Retrieve the `IZhipuApiService` instance.
    -   Register it with the `ModelManager`.
    -   Set "Zhipu" as the default provider for the application.
-   **App Settings**: Update `src/NovelManagement.WPF/appsettings.json` to add the "Zhipu" configuration section with default values.

### 3. Connect Global Sub-functions (Refactor BaseAgent)
I will update the `BaseAgent` to remove hardcoded dependencies on specific models (like "qwen2.5:7b") and instead use the globally configured default provider.

-   **BaseAgent Update**: Modify `src/NovelManagement.AI/Agents/BaseAgent.cs` in the `ExecuteTaskWithAIAsync` method.
    -   Remove the hardcoded `Model = "qwen2.5:7b"`.
    -   Update the logic to rely on `_modelManager` to route requests to the active default provider (Zhipu).
    -   Ensure the `ChatRequest` allows the provider to select its default model if none is specified.

### 4. Verification
-   I will verify the changes by checking the file content and ensuring the compilation would succeed (conceptually, as I cannot run the compiler directly).
-   I will ensure the `ZhipuApiService` correctly implements all `IModelProvider` methods to avoid runtime errors in `ModelManager`.
